#Problem 2
bond=read.table("C:\\Users\\zil20\\Desktop\\Asset Management\\wk5\\LudvigsonNg_clean.csv", header=TRUE, sep=",")
#Part (a)
#Model 1
m12=lm(yr2~f1+I(f1^3)+f2+f3+f4+f8, data=bond)
summary(m12)
m13=lm(yr3~f1+I(f1^3)+f2+f3+f4+f8, data=bond)
summary(m13)
m14=lm(yr4~f1+I(f1^3)+f2+f3+f4+f8, data=bond)
summary(m14)
m15=lm(yr5~f1+I(f1^3)+f2+f3+f4+f8, data=bond)
summary(m15)
#Model 2
m22=lm(yr2~f1+I(f1^3)+f2+f3+f4+f8+CP, data=bond)
summary(m22)
m23=lm(yr3~f1+I(f1^3)+f2+f3+f4+f8+CP, data=bond)
summary(m23)
m24=lm(yr4~f1+I(f1^3)+f2+f3+f4+f8+CP, data=bond)
summary(m24)
m25=lm(yr5~f1+I(f1^3)+f2+f3+f4+f8+CP, data=bond)
summary(m25)
#Part (b)
start=which(bond$date==19850101)
end=nrow(bond)
se_m1=c()
se_m2=c()
se_m3=c()
for (i in start:end)
{
  lm1=lm(yr5~f1+I(f1^3)+f3+f4+f8+CP, data=bond[1:(i-1),])
  m1=predict(lm1, newdata=bond[i,])
  m2=mean(bond$yr5[1:(i-1)])
  lm3=lm(yr5~CP, data=bond[1:(i-1),])
  m3=predict(lm3, newdata=bond[i,])
  se_m1=c(se_m1, (m1-bond$yr5[i])^2)
  se_m2=c(se_m2, (m2-bond$yr5[i])^2)
  se_m3=c(se_m3, (m3-bond$yr5[i])^2)
}
mean(se_m1)/mean(se_m2)
mean(se_m1)/mean(se_m3)
